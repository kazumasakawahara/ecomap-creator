# ã‚¨ã‚³ãƒãƒƒãƒ—ä½œæˆã‚¹ã‚­ãƒ« æŠ€è¡“ä»•æ§˜æ›¸

**ãƒãƒ¼ã‚¸ãƒ§ãƒ³**: 1.0.0  
**æœ€çµ‚æ›´æ–°**: 2025å¹´10æœˆ21æ—¥  
**å¯¾è±¡**: é–‹ç™ºè€…ãƒ»æŠ€è¡“æ‹…å½“è€…

---

## ğŸ“‹ ç›®æ¬¡

1. [ã‚·ã‚¹ãƒ†ãƒ ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£](#ã‚·ã‚¹ãƒ†ãƒ ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£)
2. [ãƒ‡ãƒ¼ã‚¿ãƒ•ãƒ­ãƒ¼](#ãƒ‡ãƒ¼ã‚¿ãƒ•ãƒ­ãƒ¼)
3. [æŠ€è¡“ã‚¹ã‚¿ãƒƒã‚¯](#æŠ€è¡“ã‚¹ã‚¿ãƒƒã‚¯)
4. [ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«è¨­è¨ˆ](#ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«è¨­è¨ˆ)
5. [ãƒ‡ãƒ¼ã‚¿ãƒ¢ãƒ‡ãƒ«](#ãƒ‡ãƒ¼ã‚¿ãƒ¢ãƒ‡ãƒ«)
6. [å‡¦ç†ãƒ•ãƒ­ãƒ¼](#å‡¦ç†ãƒ•ãƒ­ãƒ¼)
7. [å¯è¦–åŒ–ã‚¨ãƒ³ã‚¸ãƒ³](#å¯è¦–åŒ–ã‚¨ãƒ³ã‚¸ãƒ³)
8. [ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹è¦ä»¶](#ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹è¦ä»¶)
9. [ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£](#ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£)
10. [æ‹¡å¼µæ€§](#æ‹¡å¼µæ€§)

---

## ã‚·ã‚¹ãƒ†ãƒ ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£

### å…¨ä½“æ§‹æˆ

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     ãƒ¦ãƒ¼ã‚¶ãƒ¼                              â”‚
â”‚              (ç›¸è«‡æ”¯æ´å°‚é–€å“¡)                            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                   â”‚
                   â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              å…¥åŠ›ãƒ¬ã‚¤ãƒ¤ãƒ¼                                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                 â”‚
â”‚  â”‚ Excel/CSV    â”‚    â”‚ å¯¾è©±å…¥åŠ›      â”‚                 â”‚
â”‚  â”‚ ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆ  â”‚    â”‚ (æœªå®Ÿè£…)      â”‚                 â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                   â”‚
                   â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚             ãƒ‡ãƒ¼ã‚¿å¤‰æ›ãƒ¬ã‚¤ãƒ¤ãƒ¼                            â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  ecomap_creator.py (ãƒ¡ã‚¤ãƒ³å‡¦ç†)                  â”‚  â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”‚  â”‚
â”‚  â”‚  â”‚ Excelèª­ã¿è¾¼ã¿    â”‚  â”‚ ãƒ‡ãƒ¼ã‚¿æ¤œè¨¼       â”‚      â”‚  â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â”‚  â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”‚  â”‚
â”‚  â”‚  â”‚ æ—¥ä»˜å¤‰æ›        â”‚  â”‚ IDç”Ÿæˆ           â”‚      â”‚  â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â”‚  â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”‚  â”‚
â”‚  â”‚  â”‚ ãƒãƒ¼ãƒ‰ç”Ÿæˆ      â”‚  â”‚ ãƒªãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ç”Ÿæˆ  â”‚      â”‚  â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                   â”‚
                   â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚             ãƒ‡ãƒ¼ã‚¿ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                 â”‚
â”‚  â”‚ JSONå‡ºåŠ›     â”‚    â”‚ ã‚¹ã‚­ãƒ¼ãƒæ¤œè¨¼  â”‚                 â”‚
â”‚  â”‚ (æ§‹é€ åŒ–)     â”‚    â”‚ (schema.json) â”‚                 â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                   â”‚
                   â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚             å¯è¦–åŒ–ãƒ¬ã‚¤ãƒ¤ãƒ¼                                â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  HTMLç”Ÿæˆã‚¨ãƒ³ã‚¸ãƒ³                                 â”‚  â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”‚  â”‚
â”‚  â”‚  â”‚ D3.js/Cytoscape â”‚  â”‚ ãƒ¬ã‚¤ãƒ¤ãƒ¼åˆ¶å¾¡     â”‚      â”‚  â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â”‚  â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”‚  â”‚
â”‚  â”‚  â”‚ ã‚¤ãƒ³ã‚¿ãƒ©ã‚¯ã‚·ãƒ§ãƒ³ â”‚  â”‚ ãƒãƒ¼ãƒ‰è©³ç´°è¡¨ç¤º   â”‚      â”‚  â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                   â”‚
                   â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              å‡ºåŠ›ãƒ¬ã‚¤ãƒ¤ãƒ¼                                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                 â”‚
â”‚  â”‚ HTMLãƒ•ã‚¡ã‚¤ãƒ«  â”‚    â”‚ JSONãƒ•ã‚¡ã‚¤ãƒ«  â”‚                 â”‚
â”‚  â”‚ (å¯è¦–åŒ–)     â”‚    â”‚ (ãƒ‡ãƒ¼ã‚¿)      â”‚                 â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### è¨­è¨ˆåŸå‰‡

1. **å˜ä¸€è²¬ä»»ã®åŸå‰‡**: å„ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã¯1ã¤ã®è²¬ä»»ã®ã¿ã‚’æŒã¤
2. **ç–çµåˆ**: ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«é–“ã®ä¾å­˜é–¢ä¿‚ã‚’æœ€å°åŒ–
3. **é«˜å‡é›†**: é–¢é€£ã™ã‚‹æ©Ÿèƒ½ã‚’1ã¤ã®ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã«ã¾ã¨ã‚ã‚‹
4. **æ‹¡å¼µæ€§**: æ–°ã—ã„ãƒãƒ¼ãƒ‰ã‚¿ã‚¤ãƒ—ã‚„ãƒªãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã‚’å®¹æ˜“ã«è¿½åŠ å¯èƒ½
5. **ä¿å®ˆæ€§**: ã‚³ãƒ¼ãƒ‰ã®å¯èª­æ€§ã¨ä¿å®ˆæ€§ã‚’é‡è¦–

---

## ãƒ‡ãƒ¼ã‚¿ãƒ•ãƒ­ãƒ¼

### å‡¦ç†ã®æµã‚Œ

```
[Excelãƒ•ã‚¡ã‚¤ãƒ«]
    â”‚
    â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ãƒ•ã‚¡ã‚¤ãƒ«èª­ã¿è¾¼ã¿ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ãƒ‡ãƒ¼ã‚¿æ¤œè¨¼       â”‚
â”‚ - å¿…é ˆé …ç›®ç¢ºèª   â”‚
â”‚ - å½¢å¼ãƒã‚§ãƒƒã‚¯   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ æ—¥ä»˜å¤‰æ›         â”‚
â”‚ - å…ƒå·â†’è¥¿æš¦      â”‚
â”‚ - å¹´é½¢è¨ˆç®—       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ãƒãƒ¼ãƒ‰ç”Ÿæˆ       â”‚
â”‚ - æœ¬äººãƒãƒ¼ãƒ‰     â”‚
â”‚ - å®¶æ—ãƒãƒ¼ãƒ‰     â”‚
â”‚ - æ‰‹å¸³ãƒãƒ¼ãƒ‰     â”‚
â”‚ - ã‚µãƒ¼ãƒ“ã‚¹ãƒãƒ¼ãƒ‰ â”‚
â”‚ - (18ç¨®é¡)      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ãƒªãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ç”Ÿæˆ â”‚
â”‚ - å®¶æ—é–¢ä¿‚       â”‚
â”‚ - å¥‘ç´„é–¢ä¿‚       â”‚
â”‚ - è¨ºæ–­é–¢ä¿‚       â”‚
â”‚ - (19ç¨®é¡)      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ è¡¨ç¤ºè¨­å®šä»˜ä¸     â”‚
â”‚ - è‰²            â”‚
â”‚ - ã‚µã‚¤ã‚º         â”‚
â”‚ - ãƒ¬ã‚¤ãƒ¤ãƒ¼       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ã‚¹ã‚­ãƒ¼ãƒæ¤œè¨¼     â”‚
â”‚ - JSON Schema   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ JSONå‡ºåŠ›         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ HTMLç”Ÿæˆ         â”‚
â”‚ - D3.js/Cytoscapeâ”‚
â”‚ - ãƒ¬ã‚¤ãƒ¤ãƒ¼åˆ¶å¾¡   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â–¼
[HTMLãƒ•ã‚¡ã‚¤ãƒ«]
[JSONãƒ•ã‚¡ã‚¤ãƒ«]
```

---

## æŠ€è¡“ã‚¹ã‚¿ãƒƒã‚¯

### ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ï¼ˆPythonï¼‰

#### å¿…é ˆãƒ©ã‚¤ãƒ–ãƒ©ãƒª

| ãƒ©ã‚¤ãƒ–ãƒ©ãƒª | ãƒãƒ¼ã‚¸ãƒ§ãƒ³ | ç”¨é€” |
|-----------|-----------|------|
| Python | 3.7+ | å®Ÿè¡Œç’°å¢ƒ |
| openpyxl | 3.1.5+ | Excelèª­ã¿è¾¼ã¿ |
| json | æ¨™æº– | JSONå‡¦ç† |
| csv | æ¨™æº– | CSVå‡¦ç† |
| datetime | æ¨™æº– | æ—¥ä»˜å‡¦ç† |
| uuid | æ¨™æº– | IDç”Ÿæˆ |
| re | æ¨™æº– | æ­£è¦è¡¨ç¾ |
| argparse | æ¨™æº– | ã‚³ãƒãƒ³ãƒ‰ãƒ©ã‚¤ãƒ³å¼•æ•° |
| logging | æ¨™æº– | ãƒ­ã‚®ãƒ³ã‚° |

#### æ¨å¥¨ãƒ©ã‚¤ãƒ–ãƒ©ãƒªï¼ˆå°†æ¥çš„ãªæ‹¡å¼µï¼‰

| ãƒ©ã‚¤ãƒ–ãƒ©ãƒª | ç”¨é€” |
|-----------|------|
| jsonschema | ã‚¹ã‚­ãƒ¼ãƒæ¤œè¨¼ |
| pandas | ãƒ‡ãƒ¼ã‚¿åˆ†æï¼ˆã‚ªãƒ—ã‚·ãƒ§ãƒ³ï¼‰|
| xlrd | æ—§å½¢å¼Excelå¯¾å¿œï¼ˆ.xlsï¼‰|

### ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ï¼ˆJavaScript/HTMLï¼‰

#### å¯è¦–åŒ–ãƒ©ã‚¤ãƒ–ãƒ©ãƒª

**ã‚ªãƒ—ã‚·ãƒ§ãƒ³1: D3.js**
- ãƒãƒ¼ã‚¸ãƒ§ãƒ³: v7.x
- ç‰¹å¾´: æŸ”è»Ÿãªã‚«ã‚¹ã‚¿ãƒã‚¤ã‚ºå¯èƒ½
- åˆ©ç‚¹: ç´°ã‹ã„åˆ¶å¾¡ãŒå¯èƒ½ã€è»½é‡
- æ¬ ç‚¹: å­¦ç¿’æ›²ç·šãŒé«˜ã„

**ã‚ªãƒ—ã‚·ãƒ§ãƒ³2: Cytoscape.js**
- ãƒãƒ¼ã‚¸ãƒ§ãƒ³: 3.x
- ç‰¹å¾´: Neo4jé¢¨ã®ã‚°ãƒ©ãƒ•è¡¨ç¤º
- åˆ©ç‚¹: ã‚°ãƒ©ãƒ•è¡¨ç¤ºã«ç‰¹åŒ–ã€APIè±Šå¯Œ
- æ¬ ç‚¹: ãƒ•ã‚¡ã‚¤ãƒ«ã‚µã‚¤ã‚ºãŒå¤§ãã„

#### UI/UX

| æŠ€è¡“ | ç”¨é€” |
|------|------|
| HTML5 | ãƒãƒ¼ã‚¯ã‚¢ãƒƒãƒ— |
| CSS3 | ã‚¹ã‚¿ã‚¤ãƒªãƒ³ã‚° |
| JavaScript ES6+ | ã‚¤ãƒ³ã‚¿ãƒ©ã‚¯ã‚·ãƒ§ãƒ³ |

### é–‹ç™ºç’°å¢ƒ

| é …ç›® | æ¨å¥¨ |
|------|------|
| OS | macOSã€Linuxã€Windows |
| ã‚¨ãƒ‡ã‚£ã‚¿ | VSCodeã€PyCharm |
| ãƒãƒ¼ã‚¸ãƒ§ãƒ³ç®¡ç† | Git |
| ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ç®¡ç† | pip |

---

## ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«è¨­è¨ˆ

### ecomap_creator.pyï¼ˆãƒ¡ã‚¤ãƒ³ã‚¹ã‚¯ãƒªãƒ—ãƒˆï¼‰

#### ã‚¯ãƒ©ã‚¹æ§‹é€ 

```python
class EcomapCreator:
    """ã‚¨ã‚³ãƒãƒƒãƒ—ä½œæˆã®ãƒ¡ã‚¤ãƒ³ã‚¯ãƒ©ã‚¹"""
    
    def __init__(self, input_file: str, output_dir: str = "outputs"):
        """åˆæœŸåŒ–"""
        
    def run(self) -> tuple[str, str]:
        """ãƒ¡ã‚¤ãƒ³å‡¦ç†å®Ÿè¡Œ"""
        
    def _load_excel(self) -> dict:
        """Excelãƒ•ã‚¡ã‚¤ãƒ«èª­ã¿è¾¼ã¿"""
        
    def _validate_data(self, data: dict) -> list[str]:
        """ãƒ‡ãƒ¼ã‚¿æ¤œè¨¼"""
        
    def _convert_dates(self, data: dict) -> dict:
        """æ—¥ä»˜å¤‰æ›"""
        
    def _generate_nodes(self, data: dict) -> list[dict]:
        """ãƒãƒ¼ãƒ‰ç”Ÿæˆ"""
        
    def _generate_relations(self, nodes: list[dict]) -> list[dict]:
        """ãƒªãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ç”Ÿæˆ"""
        
    def _generate_json(self, nodes: list[dict], relations: list[dict]) -> dict:
        """JSONç”Ÿæˆ"""
        
    def _generate_html(self, json_data: dict, person_name: str) -> str:
        """HTMLç”Ÿæˆ"""
```

#### ã‚µãƒ–ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«

**1. ExcelReader**
```python
class ExcelReader:
    """Excelèª­ã¿è¾¼ã¿å°‚ç”¨ã‚¯ãƒ©ã‚¹"""
    
    @staticmethod
    def read_sheet(workbook, sheet_name: str) -> list[dict]:
        """ã‚·ãƒ¼ãƒˆèª­ã¿è¾¼ã¿"""
        
    @staticmethod
    def extract_person_info(workbook) -> dict:
        """æœ¬äººæƒ…å ±æŠ½å‡º"""
        
    @staticmethod
    def extract_family_info(workbook) -> list[dict]:
        """å®¶æ—æƒ…å ±æŠ½å‡º"""
```

**2. DateConverter**
```python
class DateConverter:
    """æ—¥ä»˜å¤‰æ›å°‚ç”¨ã‚¯ãƒ©ã‚¹"""
    
    @staticmethod
    def convert_wareki_to_seireki(date_str: str) -> str:
        """å…ƒå·â†’è¥¿æš¦å¤‰æ›"""
        
    @staticmethod
    def calculate_age(birth_date: str) -> int:
        """å¹´é½¢è¨ˆç®—"""
        
    @staticmethod
    def normalize_date(date_str: str) -> str:
        """æ—¥ä»˜æ­£è¦åŒ–"""
```

**3. NodeGenerator**
```python
class NodeGenerator:
    """ãƒãƒ¼ãƒ‰ç”Ÿæˆå°‚ç”¨ã‚¯ãƒ©ã‚¹"""
    
    def generate_person_node(self, data: dict) -> dict:
        """æœ¬äººãƒãƒ¼ãƒ‰ç”Ÿæˆ"""
        
    def generate_family_node(self, data: dict) -> dict:
        """å®¶æ—ãƒãƒ¼ãƒ‰ç”Ÿæˆ"""
        
    def generate_notebook_node(self, data: dict) -> dict:
        """æ‰‹å¸³ãƒãƒ¼ãƒ‰ç”Ÿæˆ"""
```

**4. RelationGenerator**
```python
class RelationGenerator:
    """ãƒªãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ç”Ÿæˆå°‚ç”¨ã‚¯ãƒ©ã‚¹"""
    
    def generate_family_relation(self, person_id: str, family_id: str, relation_type: str) -> dict:
        """å®¶æ—é–¢ä¿‚ç”Ÿæˆ"""
        
    def generate_contract_relation(self, person_id: str, contract_id: str) -> dict:
        """å¥‘ç´„é–¢ä¿‚ç”Ÿæˆ"""
```

**5. Validator**
```python
class Validator:
    """ãƒ‡ãƒ¼ã‚¿æ¤œè¨¼å°‚ç”¨ã‚¯ãƒ©ã‚¹"""
    
    @staticmethod
    def validate_required_fields(data: dict, required: list[str]) -> list[str]:
        """å¿…é ˆãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰æ¤œè¨¼"""
        
    @staticmethod
    def validate_date_format(date_str: str) -> bool:
        """æ—¥ä»˜å½¢å¼æ¤œè¨¼"""
        
    @staticmethod
    def validate_enum_value(value: str, allowed: list[str]) -> bool:
        """åˆ—æŒ™å‹å€¤æ¤œè¨¼"""
```

**6. HTMLGenerator**
```python
class HTMLGenerator:
    """HTMLç”Ÿæˆå°‚ç”¨ã‚¯ãƒ©ã‚¹"""
    
    def __init__(self, visualization_lib: str = "d3"):
        """åˆæœŸåŒ–ï¼ˆd3 or cytoscapeï¼‰"""
        
    def generate(self, json_data: dict, person_name: str) -> str:
        """HTMLç”Ÿæˆ"""
        
    def _generate_header(self) -> str:
        """ãƒ˜ãƒƒãƒ€ãƒ¼ç”Ÿæˆ"""
        
    def _generate_visualization_script(self, json_data: dict) -> str:
        """å¯è¦–åŒ–ã‚¹ã‚¯ãƒªãƒ—ãƒˆç”Ÿæˆ"""
        
    def _generate_layer_control(self) -> str:
        """ãƒ¬ã‚¤ãƒ¤ãƒ¼åˆ¶å¾¡UIç”Ÿæˆ"""
```

---

## ãƒ‡ãƒ¼ã‚¿ãƒ¢ãƒ‡ãƒ«

### JSONã‚¹ã‚­ãƒ¼ãƒæ§‹é€ 

```json
{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "type": "object",
  "required": ["person", "nodes", "relations", "metadata"],
  "properties": {
    "person": {
      "type": "object",
      "description": "æœ¬äººã®åŸºæœ¬æƒ…å ±"
    },
    "nodes": {
      "type": "array",
      "description": "ãƒãƒ¼ãƒ‰ã®é…åˆ—"
    },
    "relations": {
      "type": "array",
      "description": "ãƒªãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã®é…åˆ—"
    },
    "metadata": {
      "type": "object",
      "description": "ãƒ¡ã‚¿ãƒ‡ãƒ¼ã‚¿"
    }
  }
}
```

### ãƒãƒ¼ãƒ‰ãƒ¢ãƒ‡ãƒ«

```python
class Node(TypedDict):
    """ãƒãƒ¼ãƒ‰ã®å‹å®šç¾©"""
    id: str                    # UUID v4
    type: str                  # ãƒãƒ¼ãƒ‰ã‚¿ã‚¤ãƒ—ï¼ˆ18ç¨®é¡ï¼‰
    name: str                  # ãƒãƒ¼ãƒ‰å
    properties: dict           # ãƒãƒ¼ãƒ‰å›ºæœ‰ã®ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£
    display: dict              # è¡¨ç¤ºè¨­å®š
    layer: str                 # ãƒ¬ã‚¤ãƒ¤ãƒ¼å
    is_default_visible: bool   # ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆè¡¨ç¤ºãƒ•ãƒ©ã‚°
    created_at: str            # ä½œæˆæ—¥æ™‚ï¼ˆISO 8601ï¼‰
```

**displayãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ã®è©³ç´°**:
```python
display = {
    "color": str,      # è‰²ï¼ˆä¾‹: "orange", "#FF6B35"ï¼‰
    "size": str,       # ã‚µã‚¤ã‚ºï¼ˆä¾‹: "large", "medium", "small"ï¼‰
    "shape": str,      # å½¢çŠ¶ï¼ˆç¾åœ¨ã¯å…¨ã¦ "circle"ï¼‰
    "label": str,      # è¡¨ç¤ºãƒ©ãƒ™ãƒ«
    "icon": str        # ã‚¢ã‚¤ã‚³ãƒ³ï¼ˆã‚ªãƒ—ã‚·ãƒ§ãƒ³ï¼‰
}
```

### ãƒªãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ãƒ¢ãƒ‡ãƒ«

```python
class Relation(TypedDict):
    """ãƒªãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã®å‹å®šç¾©"""
    id: str                    # UUID v4
    type: str                  # ãƒªãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã‚¿ã‚¤ãƒ—ï¼ˆ19ç¨®é¡ï¼‰
    source_id: str             # å§‹ç‚¹ãƒãƒ¼ãƒ‰ID
    target_id: str             # çµ‚ç‚¹ãƒãƒ¼ãƒ‰ID
    properties: dict           # ãƒªãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³å›ºæœ‰ã®ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£
    direction: str             # æ–¹å‘ï¼ˆ"directed" or "undirected"ï¼‰
    display: dict              # è¡¨ç¤ºè¨­å®š
    layer: str                 # ãƒ¬ã‚¤ãƒ¤ãƒ¼å
    created_at: str            # ä½œæˆæ—¥æ™‚ï¼ˆISO 8601ï¼‰
```

**displayãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ã®è©³ç´°**:
```python
display = {
    "line_style": str,     # ç·šã®ã‚¹ã‚¿ã‚¤ãƒ«ï¼ˆä¾‹: "solid", "dashed"ï¼‰
    "line_width": int,     # ç·šã®å¹…ï¼ˆãƒ”ã‚¯ã‚»ãƒ«ï¼‰
    "color": str,          # è‰²
    "arrow": bool,         # çŸ¢å°ã®æœ‰ç„¡
    "label": str           # è¡¨ç¤ºãƒ©ãƒ™ãƒ«ï¼ˆã‚ªãƒ—ã‚·ãƒ§ãƒ³ï¼‰
}
```

### ãƒ¡ã‚¿ãƒ‡ãƒ¼ã‚¿ãƒ¢ãƒ‡ãƒ«

```python
class Metadata(TypedDict):
    """ãƒ¡ã‚¿ãƒ‡ãƒ¼ã‚¿ã®å‹å®šç¾©"""
    created_at: str            # ä½œæˆæ—¥æ™‚ï¼ˆISO 8601ï¼‰
    created_by: str            # ä½œæˆè€…ï¼ˆã‚·ã‚¹ãƒ†ãƒ åï¼‰
    version: str               # ãƒãƒ¼ã‚¸ãƒ§ãƒ³ç•ªå·
    schema_version: str        # ã‚¹ã‚­ãƒ¼ãƒãƒãƒ¼ã‚¸ãƒ§ãƒ³
    source_file: str           # å…ƒãƒ•ã‚¡ã‚¤ãƒ«å
    node_count: int            # ãƒãƒ¼ãƒ‰æ•°
    relation_count: int        # ãƒªãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³æ•°
    person_name: str           # æœ¬äººæ°å
    person_age: int            # æœ¬äººå¹´é½¢
```

---

## å‡¦ç†ãƒ•ãƒ­ãƒ¼

### 1. Excelèª­ã¿è¾¼ã¿ãƒ•ãƒ­ãƒ¼

```python
def _load_excel(self) -> dict:
    """
    Excelãƒ•ã‚¡ã‚¤ãƒ«ã‚’èª­ã¿è¾¼ã¿ã€è¾æ›¸å½¢å¼ã§è¿”ã™
    
    Returns:
        dict: {
            "person": {...},
            "family": [...],
            "notebooks": [...],
            "support_levels": [...],
            "diagnoses": [...],
            "legal_guardians": [...],
            "consultation_supports": [...],
            "service_plans": [...],
            "service_contracts": [...],
            "medical_institutions": [...]
        }
    """
    # 1. Excelãƒ•ã‚¡ã‚¤ãƒ«ã‚’é–‹ã
    workbook = openpyxl.load_workbook(self.input_file)
    
    # 2. å„ã‚·ãƒ¼ãƒˆã‹ã‚‰ãƒ‡ãƒ¼ã‚¿æŠ½å‡º
    data = {
        "person": self._read_person_sheet(workbook),
        "family": self._read_family_sheet(workbook),
        "notebooks": self._read_notebooks_sheet(workbook),
        # ... ä»–ã®ã‚·ãƒ¼ãƒˆ
    }
    
    # 3. ãƒ¯ãƒ¼ã‚¯ãƒ–ãƒƒã‚¯ã‚’é–‰ã˜ã‚‹
    workbook.close()
    
    return data
```

### 2. ãƒ‡ãƒ¼ã‚¿æ¤œè¨¼ãƒ•ãƒ­ãƒ¼

```python
def _validate_data(self, data: dict) -> list[str]:
    """
    ãƒ‡ãƒ¼ã‚¿ã®æ•´åˆæ€§ã‚’æ¤œè¨¼
    
    Args:
        data: èª­ã¿è¾¼ã‚“ã ãƒ‡ãƒ¼ã‚¿
        
    Returns:
        list[str]: ã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã®ãƒªã‚¹ãƒˆï¼ˆç©ºãªã‚‰ã‚¨ãƒ©ãƒ¼ãªã—ï¼‰
    """
    errors = []
    
    # 1. å¿…é ˆãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ãƒã‚§ãƒƒã‚¯
    if not data["person"].get("name"):
        errors.append("æœ¬äººã®æ°åãŒå…¥åŠ›ã•ã‚Œã¦ã„ã¾ã›ã‚“")
    
    if not data["person"].get("birth_date"):
        errors.append("æœ¬äººã®ç”Ÿå¹´æœˆæ—¥ãŒå…¥åŠ›ã•ã‚Œã¦ã„ã¾ã›ã‚“")
    
    # 2. æ—¥ä»˜å½¢å¼ãƒã‚§ãƒƒã‚¯
    for notebook in data["notebooks"]:
        if not self._is_valid_date(notebook.get("issue_date")):
            errors.append(f"æ‰‹å¸³ã®äº¤ä»˜æ—¥ãŒä¸æ­£ã§ã™: {notebook.get('issue_date')}")
    
    # 3. åˆ—æŒ™å‹å€¤ãƒã‚§ãƒƒã‚¯
    for family in data["family"]:
        if family.get("living_together") not in ["â—‹", "Ã—", "Yes", "No"]:
            errors.append(f"å®¶æ—ã®åŒå±…ãƒ•ãƒ©ã‚°ãŒä¸æ­£ã§ã™: {family.get('living_together')}")
    
    return errors
```

### 3. æ—¥ä»˜å¤‰æ›ãƒ•ãƒ­ãƒ¼

```python
def _convert_dates(self, data: dict) -> dict:
    """
    å…ƒå·ã‚’è¥¿æš¦ã«å¤‰æ›ã—ã€å¹´é½¢ã‚’è¨ˆç®—
    
    Args:
        data: èª­ã¿è¾¼ã‚“ã ãƒ‡ãƒ¼ã‚¿
        
    Returns:
        dict: å¤‰æ›å¾Œã®ãƒ‡ãƒ¼ã‚¿
    """
    converter = DateConverter()
    
    # 1. æœ¬äººã®ç”Ÿå¹´æœˆæ—¥ã‚’å¤‰æ›
    birth_date_str = data["person"]["birth_date"]
    data["person"]["birth_date"] = converter.normalize_date(birth_date_str)
    data["person"]["age"] = converter.calculate_age(data["person"]["birth_date"])
    
    # 2. å®¶æ—ã®ç”Ÿå¹´æœˆæ—¥ã‚’å¤‰æ›
    for family in data["family"]:
        if family.get("birth_date"):
            family["birth_date"] = converter.normalize_date(family["birth_date"])
            family["age"] = converter.calculate_age(family["birth_date"])
    
    # 3. å„ç¨®æ—¥ä»˜ã‚’å¤‰æ›
    for notebook in data["notebooks"]:
        notebook["issue_date"] = converter.normalize_date(notebook["issue_date"])
        if notebook.get("expiry_date"):
            notebook["expiry_date"] = converter.normalize_date(notebook["expiry_date"])
    
    return data
```

### 4. ãƒãƒ¼ãƒ‰ç”Ÿæˆãƒ•ãƒ­ãƒ¼

```python
def _generate_nodes(self, data: dict) -> list[dict]:
    """
    ãƒ‡ãƒ¼ã‚¿ã‹ã‚‰ãƒãƒ¼ãƒ‰ã‚’ç”Ÿæˆ
    
    Args:
        data: å¤‰æ›å¾Œã®ãƒ‡ãƒ¼ã‚¿
        
    Returns:
        list[dict]: ãƒãƒ¼ãƒ‰ã®ãƒªã‚¹ãƒˆ
    """
    generator = NodeGenerator()
    nodes = []
    
    # 1. æœ¬äººãƒãƒ¼ãƒ‰ç”Ÿæˆï¼ˆå¿…é ˆï¼‰
    person_node = generator.generate_person_node(data["person"])
    nodes.append(person_node)
    
    # 2. å®¶æ—ãƒãƒ¼ãƒ‰ç”Ÿæˆ
    for family_data in data["family"]:
        family_node = generator.generate_family_node(family_data)
        nodes.append(family_node)
    
    # 3. æ‰‹å¸³ãƒãƒ¼ãƒ‰ç”Ÿæˆ
    for notebook_data in data["notebooks"]:
        notebook_node = generator.generate_notebook_node(notebook_data)
        nodes.append(notebook_node)
    
    # 4. ãã®ä»–ã®ãƒãƒ¼ãƒ‰ç”Ÿæˆ
    # ... æ”¯æ´åŒºåˆ†ã€è¨ºæ–­ã€æˆå¹´å¾Œè¦‹ã€ã‚µãƒ¼ãƒ“ã‚¹ãªã©
    
    return nodes
```

### 5. ãƒªãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ç”Ÿæˆãƒ•ãƒ­ãƒ¼

```python
def _generate_relations(self, nodes: list[dict]) -> list[dict]:
    """
    ãƒãƒ¼ãƒ‰é–“ã®ãƒªãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã‚’ç”Ÿæˆ
    
    Args:
        nodes: ãƒãƒ¼ãƒ‰ã®ãƒªã‚¹ãƒˆ
        
    Returns:
        list[dict]: ãƒªãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã®ãƒªã‚¹ãƒˆ
    """
    generator = RelationGenerator()
    relations = []
    
    # 1. æœ¬äººãƒãƒ¼ãƒ‰ã‚’å–å¾—
    person_node = next(n for n in nodes if n["type"] == "Person")
    
    # 2. å®¶æ—ãƒªãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ç”Ÿæˆ
    family_nodes = [n for n in nodes if n["type"] == "Family"]
    for family_node in family_nodes:
        relation = generator.generate_family_relation(
            person_node["id"],
            family_node["id"],
            family_node["properties"]["relation_type"]
        )
        relations.append(relation)
    
    # 3. æ‰‹å¸³ãƒªãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ç”Ÿæˆ
    notebook_nodes = [n for n in nodes if "Notebook" in n["type"]]
    for notebook_node in notebook_nodes:
        relation = generator.generate_notebook_relation(
            person_node["id"],
            notebook_node["id"]
        )
        relations.append(relation)
    
    # 4. ãã®ä»–ã®ãƒªãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ç”Ÿæˆ
    # ...
    
    return relations
```

---

## å¯è¦–åŒ–ã‚¨ãƒ³ã‚¸ãƒ³

### D3.jsã«ã‚ˆã‚‹å®Ÿè£…ä¾‹

```javascript
// ã‚°ãƒ©ãƒ•ãƒ‡ãƒ¼ã‚¿ã®æº–å‚™
const graphData = {
    nodes: jsonData.nodes.map(n => ({
        id: n.id,
        name: n.name,
        type: n.type,
        color: n.display.color,
        size: n.display.size === "large" ? 50 : n.display.size === "medium" ? 30 : 20,
        layer: n.layer,
        visible: n.is_default_visible
    })),
    links: jsonData.relations.map(r => ({
        source: r.source_id,
        target: r.target_id,
        type: r.type,
        directed: r.direction === "directed"
    }))
};

// D3.js force simulationã®è¨­å®š
const simulation = d3.forceSimulation(graphData.nodes)
    .force("link", d3.forceLink(graphData.links).id(d => d.id).distance(100))
    .force("charge", d3.forceManyBody().strength(-300))
    .force("center", d3.forceCenter(width / 2, height / 2))
    .force("collision", d3.forceCollide().radius(d => d.size + 10));

// SVGè¦ç´ ã®ä½œæˆ
const svg = d3.select("#ecomap")
    .append("svg")
    .attr("width", width)
    .attr("height", height);

// ãƒªãƒ³ã‚¯ã®æç”»
const link = svg.append("g")
    .selectAll("line")
    .data(graphData.links)
    .enter().append("line")
    .attr("stroke", "#999")
    .attr("stroke-width", 2);

// ãƒãƒ¼ãƒ‰ã®æç”»
const node = svg.append("g")
    .selectAll("circle")
    .data(graphData.nodes)
    .enter().append("circle")
    .attr("r", d => d.size)
    .attr("fill", d => d.color)
    .call(drag(simulation));

// ãƒ©ãƒ™ãƒ«ã®æç”»
const label = svg.append("g")
    .selectAll("text")
    .data(graphData.nodes)
    .enter().append("text")
    .text(d => d.name)
    .attr("font-size", 12)
    .attr("dx", 15)
    .attr("dy", 4);

// ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã®æ›´æ–°
simulation.on("tick", () => {
    link
        .attr("x1", d => d.source.x)
        .attr("y1", d => d.source.y)
        .attr("x2", d => d.target.x)
        .attr("y2", d => d.target.y);
    
    node
        .attr("cx", d => d.x)
        .attr("cy", d => d.y);
    
    label
        .attr("x", d => d.x)
        .attr("y", d => d.y);
});
```

### Cytoscape.jsã«ã‚ˆã‚‹å®Ÿè£…ä¾‹

```javascript
// Cytoscape.jsã®åˆæœŸåŒ–
const cy = cytoscape({
    container: document.getElementById('ecomap'),
    
    elements: [
        // ãƒãƒ¼ãƒ‰
        ...jsonData.nodes.map(n => ({
            data: {
                id: n.id,
                label: n.name,
                type: n.type,
                layer: n.layer
            },
            style: {
                'background-color': n.display.color,
                'width': n.display.size === 'large' ? 50 : 30,
                'height': n.display.size === 'large' ? 50 : 30
            }
        })),
        
        // ã‚¨ãƒƒã‚¸
        ...jsonData.relations.map(r => ({
            data: {
                source: r.source_id,
                target: r.target_id,
                label: r.type
            }
        }))
    ],
    
    style: [
        {
            selector: 'node',
            style: {
                'label': 'data(label)',
                'text-valign': 'center',
                'text-halign': 'right',
                'font-size': '12px'
            }
        },
        {
            selector: 'edge',
            style: {
                'width': 2,
                'line-color': '#999',
                'target-arrow-color': '#999',
                'target-arrow-shape': 'triangle'
            }
        }
    ],
    
    layout: {
        name: 'cose',  // Force-directed layout
        animate: true,
        nodeRepulsion: 8000,
        idealEdgeLength: 100
    }
});

// ã‚¤ãƒ™ãƒ³ãƒˆãƒãƒ³ãƒ‰ãƒ©ãƒ¼
cy.on('tap', 'node', function(evt){
    const node = evt.target;
    showNodeDetails(node.data());
});
```

### ãƒ¬ã‚¤ãƒ¤ãƒ¼åˆ¶å¾¡ã®å®Ÿè£…

```javascript
// ãƒ¬ã‚¤ãƒ¤ãƒ¼åˆ‡ã‚Šæ›¿ãˆé–¢æ•°
function toggleLayer(layerName, visible) {
    // ãƒãƒ¼ãƒ‰ã®è¡¨ç¤º/éè¡¨ç¤º
    cy.nodes().forEach(node => {
        if (node.data('layer') === layerName) {
            if (visible) {
                node.style('display', 'element');
            } else {
                node.style('display', 'none');
            }
        }
    });
    
    // ã‚¨ãƒƒã‚¸ã®è¡¨ç¤º/éè¡¨ç¤º
    cy.edges().forEach(edge => {
        const sourceLayer = edge.source().data('layer');
        const targetLayer = edge.target().data('layer');
        
        if (sourceLayer === layerName || targetLayer === layerName) {
            if (visible && 
                edge.source().style('display') !== 'none' &&
                edge.target().style('display') !== 'none') {
                edge.style('display', 'element');
            } else {
                edge.style('display', 'none');
            }
        }
    });
}

// UIã‚¤ãƒ™ãƒ³ãƒˆ
document.getElementById('layer-family').addEventListener('change', function(e) {
    toggleLayer('family', e.target.checked);
});

document.getElementById('layer-medical').addEventListener('change', function(e) {
    toggleLayer('medical', e.target.checked);
});
```

---

## ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹è¦ä»¶

### å‡¦ç†æ™‚é–“ç›®æ¨™

| å‡¦ç† | ç›®æ¨™æ™‚é–“ | æœ€å¤§è¨±å®¹æ™‚é–“ |
|------|---------|-------------|
| Excelèª­ã¿è¾¼ã¿ | < 1ç§’ | 3ç§’ |
| ãƒ‡ãƒ¼ã‚¿å¤‰æ› | < 0.5ç§’ | 1ç§’ |
| ãƒãƒ¼ãƒ‰ç”Ÿæˆ | < 1ç§’ | 2ç§’ |
| JSONå‡ºåŠ› | < 0.5ç§’ | 1ç§’ |
| HTMLç”Ÿæˆ | < 1ç§’ | 2ç§’ |
| **åˆè¨ˆ** | **< 4ç§’** | **9ç§’** |

### ãƒ¡ãƒ¢ãƒªä½¿ç”¨é‡

| ãƒ‡ãƒ¼ã‚¿è¦æ¨¡ | æ¨å¥¨ãƒ¡ãƒ¢ãƒª | æœ€å¤§ãƒ¡ãƒ¢ãƒª |
|-----------|-----------|-----------|
| å°è¦æ¨¡ï¼ˆ~20ãƒãƒ¼ãƒ‰ï¼‰ | 50MB | 100MB |
| ä¸­è¦æ¨¡ï¼ˆ~50ãƒãƒ¼ãƒ‰ï¼‰ | 100MB | 200MB |
| å¤§è¦æ¨¡ï¼ˆ~100ãƒãƒ¼ãƒ‰ï¼‰ | 200MB | 400MB |

### ãƒ•ã‚¡ã‚¤ãƒ«ã‚µã‚¤ã‚º

| ãƒ•ã‚¡ã‚¤ãƒ« | æ¨å¥¨ã‚µã‚¤ã‚º | æœ€å¤§ã‚µã‚¤ã‚º |
|---------|----------|-----------|
| JSONãƒ•ã‚¡ã‚¤ãƒ« | < 100KB | 500KB |
| HTMLãƒ•ã‚¡ã‚¤ãƒ« | < 500KB | 1MB |

### æœ€é©åŒ–æˆ¦ç•¥

1. **é…å»¶èª­ã¿è¾¼ã¿**: ã‚·ãƒ¼ãƒˆã”ã¨ã«é †æ¬¡èª­ã¿è¾¼ã¿
2. **ã‚­ãƒ£ãƒƒã‚·ãƒ³ã‚°**: å¤‰æ›æ¸ˆã¿ãƒ‡ãƒ¼ã‚¿ã®ã‚­ãƒ£ãƒƒã‚·ãƒ¥
3. **ä¸¦åˆ—å‡¦ç†**: å¯èƒ½ãªéƒ¨åˆ†ã¯ä¸¦åˆ—åŒ–ï¼ˆå°†æ¥çš„ãªæ‹¡å¼µï¼‰
4. **ã‚¹ãƒˆãƒªãƒ¼ãƒŸãƒ³ã‚°**: å¤§è¦æ¨¡ãƒ‡ãƒ¼ã‚¿ã®å ´åˆã¯ã‚¹ãƒˆãƒªãƒ¼ãƒŸãƒ³ã‚°å‡¦ç†

---

## ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£

### ãƒ‡ãƒ¼ã‚¿ä¿è­·

1. **ãƒ­ãƒ¼ã‚«ãƒ«å‡¦ç†**: å…¨ã¦ã®å‡¦ç†ã¯ãƒ­ãƒ¼ã‚«ãƒ«ç’°å¢ƒã§å®Ÿè¡Œ
2. **å¤–éƒ¨é€šä¿¡ãªã—**: ã‚¤ãƒ³ã‚¿ãƒ¼ãƒãƒƒãƒˆçµŒç”±ã®ãƒ‡ãƒ¼ã‚¿é€ä¿¡ãªã—
3. **ãƒ•ã‚¡ã‚¤ãƒ«æ¨©é™**: ç”Ÿæˆãƒ•ã‚¡ã‚¤ãƒ«ã®é©åˆ‡ãªæ¨©é™è¨­å®š

### å…¥åŠ›æ¤œè¨¼

1. **ãƒ•ã‚¡ã‚¤ãƒ«å½¢å¼ãƒã‚§ãƒƒã‚¯**: è¨±å¯ã•ã‚ŒãŸå½¢å¼ã®ã¿å‡¦ç†
2. **ãƒ‡ãƒ¼ã‚¿ã‚µã‚¤ã‚ºåˆ¶é™**: ç•°å¸¸ã«å¤§ãã„ãƒ‡ãƒ¼ã‚¿ã®æ‹’å¦
3. **SQLã‚¤ãƒ³ã‚¸ã‚§ã‚¯ã‚·ãƒ§ãƒ³å¯¾ç­–**: ä¸è¦ï¼ˆãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ä¸ä½¿ç”¨ï¼‰
4. **XSSå¯¾ç­–**: HTMLç”Ÿæˆæ™‚ã®ã‚¨ã‚¹ã‚±ãƒ¼ãƒ—å‡¦ç†

### ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°

```python
try:
    # å‡¦ç†
    result = process_data(input_file)
except FileNotFoundError:
    logger.error(f"ãƒ•ã‚¡ã‚¤ãƒ«ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“: {input_file}")
    raise
except ValidationError as e:
    logger.error(f"ãƒ‡ãƒ¼ã‚¿æ¤œè¨¼ã‚¨ãƒ©ãƒ¼: {e}")
    raise
except Exception as e:
    logger.error(f"äºˆæœŸã—ãªã„ã‚¨ãƒ©ãƒ¼: {e}", exc_info=True)
    raise
finally:
    # ã‚¯ãƒªãƒ¼ãƒ³ã‚¢ãƒƒãƒ—å‡¦ç†
    cleanup()
```

---

## æ‹¡å¼µæ€§

### æ–°ã—ã„ãƒãƒ¼ãƒ‰ã‚¿ã‚¤ãƒ—ã®è¿½åŠ 

1. `schema.json` ã«ãƒãƒ¼ãƒ‰ã‚¿ã‚¤ãƒ—å®šç¾©ã‚’è¿½åŠ 
2. `NodeGenerator` ã‚¯ãƒ©ã‚¹ã«ç”Ÿæˆãƒ¡ã‚½ãƒƒãƒ‰ã‚’è¿½åŠ 
3. `ExcelReader` ã‚¯ãƒ©ã‚¹ã«ã‚·ãƒ¼ãƒˆèª­ã¿è¾¼ã¿ãƒ¡ã‚½ãƒƒãƒ‰ã‚’è¿½åŠ 
4. ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã«æ–°ã—ã„ã‚·ãƒ¼ãƒˆã‚’è¿½åŠ 

### æ–°ã—ã„ãƒªãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã‚¿ã‚¤ãƒ—ã®è¿½åŠ 

1. `schema.json` ã«ãƒªãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã‚¿ã‚¤ãƒ—å®šç¾©ã‚’è¿½åŠ 
2. `RelationGenerator` ã‚¯ãƒ©ã‚¹ã«ç”Ÿæˆãƒ¡ã‚½ãƒƒãƒ‰ã‚’è¿½åŠ 
3. ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã‚’æ›´æ–°

### CSVå½¢å¼ã®ã‚µãƒãƒ¼ãƒˆ

```python
class CSVReader:
    """CSVèª­ã¿è¾¼ã¿ã‚¯ãƒ©ã‚¹"""
    
    @staticmethod
    def read_csv(file_path: str) -> list[dict]:
        """CSVãƒ•ã‚¡ã‚¤ãƒ«ã‚’èª­ã¿è¾¼ã¿"""
        with open(file_path, 'r', encoding='utf-8') as f:
            reader = csv.DictReader(f)
            return list(reader)
```

### ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹é€£æºï¼ˆå°†æ¥çš„ãªæ‹¡å¼µï¼‰

```python
class DatabaseConnector:
    """ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹æ¥ç¶šã‚¯ãƒ©ã‚¹ï¼ˆå°†æ¥çš„ãªæ‹¡å¼µï¼‰"""
    
    def __init__(self, db_path: str):
        """åˆæœŸåŒ–"""
        
    def save_ecomap(self, json_data: dict) -> int:
        """ã‚¨ã‚³ãƒãƒƒãƒ—ã‚’ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã«ä¿å­˜"""
        
    def load_ecomap(self, ecomap_id: int) -> dict:
        """ã‚¨ã‚³ãƒãƒƒãƒ—ã‚’ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã‹ã‚‰èª­ã¿è¾¼ã¿"""
```

---

## ä»˜éŒ²

### ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªæ§‹é€ ï¼ˆè©³ç´°ç‰ˆï¼‰

```
~/AI-Workspace/ecomap-creator/
â”œâ”€â”€ ecomap_creator.py          # ãƒ¡ã‚¤ãƒ³ã‚¹ã‚¯ãƒªãƒ—ãƒˆ
â”œâ”€â”€ modules/                   # ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒª
â”‚   â”œâ”€â”€ __init__.py
â”‚   â”œâ”€â”€ excel_reader.py       # Excelèª­ã¿è¾¼ã¿
â”‚   â”œâ”€â”€ date_converter.py     # æ—¥ä»˜å¤‰æ›
â”‚   â”œâ”€â”€ node_generator.py     # ãƒãƒ¼ãƒ‰ç”Ÿæˆ
â”‚   â”œâ”€â”€ relation_generator.py # ãƒªãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ç”Ÿæˆ
â”‚   â”œâ”€â”€ validator.py          # ãƒ‡ãƒ¼ã‚¿æ¤œè¨¼
â”‚   â””â”€â”€ html_generator.py     # HTMLç”Ÿæˆ
â”œâ”€â”€ templates/                 # ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆ
â”‚   â”œâ”€â”€ template.xlsx
â”‚   â””â”€â”€ html_template.html    # HTMLç”Ÿæˆç”¨ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆ
â”œâ”€â”€ samples/                   # ã‚µãƒ³ãƒ—ãƒ«ãƒ‡ãƒ¼ã‚¿
â”‚   â”œâ”€â”€ sample_case_01.xlsx
â”‚   â”œâ”€â”€ sample_case_01.json
â”‚   â”œâ”€â”€ sample_case_02.xlsx
â”‚   â”œâ”€â”€ sample_case_02.json
â”‚   â”œâ”€â”€ sample_case_03.xlsx
â”‚   â””â”€â”€ sample_case_03.json
â”œâ”€â”€ outputs/                   # å‡ºåŠ›ãƒ•ã‚¡ã‚¤ãƒ«
â”‚   â””â”€â”€ (ç”Ÿæˆã•ã‚ŒãŸãƒ•ã‚¡ã‚¤ãƒ«)
â”œâ”€â”€ tests/                     # ãƒ†ã‚¹ãƒˆã‚³ãƒ¼ãƒ‰
â”‚   â”œâ”€â”€ __init__.py
â”‚   â”œâ”€â”€ test_excel_reader.py
â”‚   â”œâ”€â”€ test_date_converter.py
â”‚   â”œâ”€â”€ test_node_generator.py
â”‚   â””â”€â”€ test_validator.py
â”œâ”€â”€ docs/                      # ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ
â”‚   â”œâ”€â”€ SKILL.md
â”‚   â”œâ”€â”€ TECHNICAL_SPEC.md     # ã“ã®ãƒ•ã‚¡ã‚¤ãƒ«
â”‚   â”œâ”€â”€ API_SPEC.md
â”‚   â”œâ”€â”€ USAGE_GUIDE.md
â”‚   â””â”€â”€ DATA_CONVERSION_RULES.md
â”œâ”€â”€ schema.json               # JSONã‚¹ã‚­ãƒ¼ãƒ
â”œâ”€â”€ requirements.txt          # ä¾å­˜ãƒ©ã‚¤ãƒ–ãƒ©ãƒª
â”œâ”€â”€ setup.py                  # ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—ã‚¹ã‚¯ãƒªãƒ—ãƒˆ
â”œâ”€â”€ .gitignore               # Gitç„¡è¦–ãƒ•ã‚¡ã‚¤ãƒ«
â””â”€â”€ README.md                 # ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆæ¦‚è¦
```

### ä¾å­˜ãƒ©ã‚¤ãƒ–ãƒ©ãƒªï¼ˆrequirements.txtï¼‰

```
openpyxl>=3.1.5
jsonschema>=4.0.0
```

### ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—ã‚¹ã‚¯ãƒªãƒ—ãƒˆï¼ˆsetup.pyï¼‰

```python
from setuptools import setup, find_packages

setup(
    name='ecomap-creator',
    version='1.0.0',
    description='ã‚¨ã‚³ãƒãƒƒãƒ—ä½œæˆã‚¹ã‚­ãƒ«',
    author='K. Kawahara',
    packages=find_packages(),
    install_requires=[
        'openpyxl>=3.1.5',
    ],
    entry_points={
        'console_scripts': [
            'ecomap=ecomap_creator:main',
        ],
    },
)
```

---

**ä»¥ä¸Šã€ã‚¨ã‚³ãƒãƒƒãƒ—ä½œæˆã‚¹ã‚­ãƒ«ã®æŠ€è¡“ä»•æ§˜æ›¸ã§ã—ãŸã€‚**
